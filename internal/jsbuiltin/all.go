package jsbuiltin

var modules []JsModule

func init() {
	// builtin_cli.js
	modules = append(modules, JsModule{File: "builtin_cli.js", Code: "Y29uc3QgY2xpID0ge307Cgp7CiAgY29uc3QgYXJncyA9IFtdOwogIGNvbnN0IG9wdHMgPSB7fTsKCiAgZnVuY3Rpb24gZ2V0RmxhZ05hbWUocykgewogICAgaWYgKHMuc3RhcnRzV2l0aCgiLS0iKSkgewogICAgICByZXR1cm4gcy5zbGljZSgyKTsKICAgIH0KICAgIGlmIChzLnN0YXJ0c1dpdGgoIi0iKSkgewogICAgICByZXR1cm4gcy5zbGljZSgxKTsKICAgIH0KICB9CgogIGZvciAobGV0IGkgPSAyOyBpIDwgX19hcmdzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCB2ID0gX19hcmdzW2ldOwogICAgY29uc3QgdjIgPSBfX2FyZ3NbaSArIDFdOwogICAgaWYgKHYuc3RhcnRzV2l0aCgiLSIpKSB7CiAgICAgIGNvbnN0IHIgPSB2Lm1hdGNoKC9eLS0/KFtcd1wtX10rKT0oLiopJC8pOwogICAgICBpZiAocikgewogICAgICAgIG9wdHNbclsxXV0gPSByWzJdOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh2MiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBpZiAodjIuc3RhcnRzV2l0aCgiLSIpKSB7CiAgICAgICAgICAgIG9wdHNbZ2V0RmxhZ05hbWUodildID0gdHJ1ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9wdHNbZ2V0RmxhZ05hbWUodildID0gdjI7CiAgICAgICAgICAgIGkrKzsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgb3B0c1tnZXRGbGFnTmFtZSh2KV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgYXJncy5wdXNoKHYpOwogICAgfQogIH0KCiAgY2xpLmdldCA9IGZ1bmN0aW9uIGdldChuKSB7CiAgICBpZiAodHlwZW9mIG4gPT09ICJudW1iZXIiKSB7CiAgICAgIHJldHVybiBhcmdzW25dOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG9wdHNbbl07CiAgICB9CiAgfTsKCiAgY2xpLmJvb2wgPSBmdW5jdGlvbiBib29sKG4pIHsKICAgIGlmIChvcHRzW25dID09PSBmYWxzZSB8fCBvcHRzW25dID09PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZTsKICAgIGlmIChvcHRzW25dID09PSB0cnVlKSByZXR1cm4gdHJ1ZTsKICAgIGNvbnN0IHMgPSBvcHRzW25dLnRvTG93ZXJDYXNlKCk7CiAgICByZXR1cm4gIShzID09PSAiMCIgfHwgcyA9PT0gImYiIHx8IHMgPT09ICJmYWxzZSIpOwogIH07CgogIGNsaS5hcmdzID0gZnVuY3Rpb24gYXJncygpIHsKICAgIHJldHVybiBbLi4uYXJnc107CiAgfTsKCiAgY2xpLm9wdHMgPSBmdW5jdGlvbiBvcHRzKCkgewogICAgcmV0dXJuIHsgLi4ub3B0cyB9OwogIH07CgogIGNsaS5wcm9tcHQgPSBmdW5jdGlvbiBwcm9tcHQobWVzc2FnZSkgewogICAgaWYgKG1lc3NhZ2UpIHByaW50KG1lc3NhZ2UpOwogICAgcmV0dXJuIHJlYWRsaW5lKCk7CiAgfTsKCiAgY2xpLl9zdWJjb21tYW5kID0ge307CgogIGNsaS5zdWJjb21tYW5kID0gZnVuY3Rpb24gc3ViY29tbWFuZChuYW1lLCBjYWxsYmFjaykgewogICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gYGZ1bmN0aW9uYCkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBjYWxsYmFjayBleHBlY3RlZCBhIGZ1bmN0aW9uYCk7CiAgICB9CiAgICBpZiAoY2xpLl9zdWJjb21tYW5kW25hbWVdKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgc3ViY29tbWFuZCAke25hbWV9IGlzIGFscmVhZHkgcmVnaXN0ZXJlZGApOwogICAgfQogICAgY2xpLl9zdWJjb21tYW5kW25hbWVdID0gY2FsbGJhY2s7CiAgfTsKCiAgY2xpLnN1YmNvbW1hbmRzdGFydCA9IGZ1bmN0aW9uIHN1YmNvbW1hbmRzdGFydCgpIHsKICAgIGNvbnN0IG5hbWUgPSBjbGkuZ2V0KDApOwogICAgaWYgKGNsaS5fc3ViY29tbWFuZFtuYW1lXSkgewogICAgICByZXR1cm4gY2xpLl9zdWJjb21tYW5kW25hbWVdKCk7CiAgICB9CiAgICBpZiAoY2xpLl9zdWJjb21tYW5kW2AqYF0pIHsKICAgICAgcmV0dXJuIGNsaS5fc3ViY29tbWFuZFtgKmBdKCk7CiAgICB9CiAgICB0aHJvdyBuZXcgRXJyb3IoYHVucmVjb2duaXplZCBzdWJjb21tYW5kICR7bmFtZX1gKTsKICB9Owp9Cg=="})

	// builtin_global.js
	modules = append(modules, JsModule{File: "builtin_global.js", Code: "ZnVuY3Rpb24gcmFuZG9tc3RyaW5nKHNpemUsIGNoYXJzKSB7CiAgc2l6ZSA9IHNpemUgfHwgNjsKICBjaGFycyA9CiAgICBjaGFycyB8fCAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkiOwogIGNvbnN0IG1heCA9IGNoYXJzLmxlbmd0aDsKICBsZXQgcmV0ID0gIiI7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKICAgIHJldCArPSBjaGFycy5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4KSk7CiAgfQogIHJldHVybiByZXQ7Cn0K"})

	// builtin_log.js
	modules = append(modules, JsModule{File: "builtin_log.js", Code: "ZnVuY3Rpb24gcHJpbnRsbiguLi5hcmdzKSB7CiAgcHJpbnQoLi4uYXJncyk7CiAgcHJpbnQoIlxuIik7Cn0KCmNvbnN0IGxvZyA9IHt9Owp7CiAgY29uc3QgbGV2ZWxzID0geyBFUlJPUjogMSwgSU5GTzogMiwgREVCVUc6IDMgfTsKICBjb25zdCBsb2dMZXZlbCA9IGxldmVsc1soX19lbnZbIkpTU0hfTE9HIl0gfHwgIklORk8iKS50b1VwcGVyQ2FzZSgpXTsKCiAgY29uc3QgcmVzZXQgPSBgXHUwMDFiWzBtYDsKCiAgZnVuY3Rpb24gcmVkKGxpbmUpIHsKICAgIHJldHVybiBgXHUwMDFiWzMxOzFtJHtsaW5lfSR7cmVzZXR9YDsKICB9CgogIGZ1bmN0aW9uIGdyZWVuKGxpbmUpIHsKICAgIHJldHVybiBgXHUwMDFiWzMyOzFtJHtsaW5lfSR7cmVzZXR9YDsKICB9CgogIGZ1bmN0aW9uIGdyYXkobGluZSkgewogICAgcmV0dXJuIGBcdTAwMWJbMjsxbSR7bGluZX0ke3Jlc2V0fWA7CiAgfQoKICBsb2cuZGVidWcgPSBmdW5jdGlvbiBkZWJ1ZyhtZXNzYWdlLCAuLi5hcmdzKSB7CiAgICBpZiAobG9nTGV2ZWwgPj0gbGV2ZWxzLkRFQlVHKSB7CiAgICAgIHN0ZG91dGxvZyhncmF5KGZvcm1hdChtZXNzYWdlLCAuLi5hcmdzKSkpOwogICAgfQogIH07CgogIGxvZy5pbmZvID0gZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCAuLi5hcmdzKSB7CiAgICBpZiAobG9nTGV2ZWwgPj0gbGV2ZWxzLklORk8pIHsKICAgICAgc3Rkb3V0bG9nKGdyZWVuKGZvcm1hdChtZXNzYWdlLCAuLi5hcmdzKSkpOwogICAgfQogIH07CgogIGxvZy5lcnJvciA9IGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIC4uLmFyZ3MpIHsKICAgIGlmIChsb2dMZXZlbCA+PSBsZXZlbHMuRVJST1IpIHsKICAgICAgc3RkZXJybG9nKHJlZChmb3JtYXQobWVzc2FnZSwgLi4uYXJncykpKTsKICAgIH0KICB9OwoKICBsb2cuZmF0YWwgPSBmdW5jdGlvbiBmYXRhbChtZXNzYWdlLCAuLi5hcmdzKSB7CiAgICBsb2cuZXJyb3IobWVzc2FnZSwgLi4uYXJncyk7CiAgICBleGl0KDEpOwogIH07Cn0K"})
}
